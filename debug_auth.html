<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Authentication</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-8">
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow p-6">
        <h1 class="text-2xl font-bold mb-4">Debug Authentication</h1>
        
        <div class="mb-6">
            <h2 class="text-lg font-semibold mb-2">Session Storage:</h2>
            <div id="session-info" class="bg-gray-100 p-4 rounded">
                <!-- Se llenará con JavaScript -->
            </div>
        </div>
        
        <div class="mb-6">
            <h2 class="text-lg font-semibold mb-2">Acciones:</h2>
            <div class="space-y-2">
                <button onclick="clearSession()" class="bg-red-500 text-white px-4 py-2 rounded">
                    Limpiar Sesión
                </button>
                <button onclick="testPaymentAdmin()" class="bg-blue-500 text-white px-4 py-2 rounded">
                    Probar Payment Admin
                </button>
                <button onclick="testAdmin()" class="bg-green-500 text-white px-4 py-2 rounded">
                    Probar Admin
                </button>
            </div>
        </div>
        
        <div class="mb-6">
            <h2 class="text-lg font-semibold mb-2">Console Logs:</h2>
            <div class="bg-black text-green-400 p-4 rounded font-mono text-sm h-32 overflow-y-auto" id="console-logs">
                <!-- Se llenará con logs -->
            </div>
        </div>
    </div>

    <script>
        // Capturar console.log
        const originalLog = console.log;
        const consoleDiv = document.getElementById('console-logs');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const logEntry = document.createElement('div');
            logEntry.textContent = args.join(' ');
            consoleDiv.appendChild(logEntry);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        };

        function updateSessionInfo() {
            const sessionInfo = document.getElementById('session-info');
            const authData = {
                'admin_authenticated': sessionStorage.getItem('admin_authenticated'),
                'admin_user': sessionStorage.getItem('admin_user'),
                'admin_user_id': sessionStorage.getItem('admin_user_id'),
                'admin_login_time': sessionStorage.getItem('admin_login_time'),
                'redirect_after_login': sessionStorage.getItem('redirect_after_login')
            };
            
            sessionInfo.innerHTML = Object.entries(authData)
                .map(([key, value]) => `<div><strong>${key}:</strong> ${value || 'null'}</div>`)
                .join('');
        }

        function clearSession() {
            sessionStorage.clear();
            updateSessionInfo();
            console.log('Session cleared');
        }

        function testPaymentAdmin() {
            console.log('Testing payment admin access...');
            window.location.href = 'payment_admin.html';
        }

        function testAdmin() {
            console.log('Testing admin access...');
            window.location.href = 'admin.html';
        }

        // Actualizar info al cargar
        updateSessionInfo();
        
        // Actualizar info cada segundo
        setInterval(updateSessionInfo, 1000);
    </script>
</body>
</html>
